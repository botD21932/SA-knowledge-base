**SOAP (Service Oriented Architecture Protocol) -** проткол обмена структурированными сообщениями между системами в распределённой среде. Он используется в веб-службах для передачи данных независимо от платформы, языка программирования и архитектуры. SOAP базирутся на [[XML]], что делает его читаемым для человека и совместимым с различными технологиями.

**Ключевые особенности SOAP:**
1) **Основан на XML.** Все сообщения формируются в формате XML, обеспечивая независимость от платформ и языков программирования
2) **Операционная нейтральность.** SOAP можно использовать с любым транспортом, включая [[HTTP]], [[SMTP]], [[TCP]] и другие
3) **Форматирование.** Сообщения строго структурированны и соответствуют определённым стандартам
4) **Поддержка стандартов.** SOAP поддерживает WS-стандарты, такие как [[WS-Security]] для обеспечения безопасности
5) **Контрактно-ориентированность.** Использует WSDL для описания предоставляемых операций
6) **Надёжность и расширяемость.** Включает механизмы обработки ошибок и добавления дполонительных элементов без нарушения структуры

**Структура SOAP-сообщения:**
1) **Envelope.** Обязательный элемент, который заключает всё сообщение SOAP
2) **Header.** Дополнительный элемент для метаданных (например, аутентификации)
3) **Body.** Обязательная часть, содержащая фактические данные запроса или ответа
4) **Fault.** Опциональный элемент для передачи информации об ошибках

**Пример SOAP-запроса:**
``` xml
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
     <getProductDetails xmlns="http://warehouse.example.com/ws">
       <productID>12345</productID>
     </getProductDetails>
   </soap:Body>
</soap:Envelope>
```

**Пример SOAP-ответа:**
``` xml
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
     <getProductDetailsResponse xmlns="http://warehouse.example.com/ws">
       <getProductDetailsResult>
         <productID>12345</productID>
         <productName>Стакан граненый</productName>
         <description>Стакан граненый. 250 мл.</description>
         <price>9.95</price>
         <currency>
             <code>840</code>
             <alpha3>USD</alpha3>
             <sign>$</sign>
             <name>US dollar</name>
             <accuracy>2</accuracy>
         </currency>
         <inStock>true</inStock>
       </getProductDetailsResult>
     </getProductDetailsResponse>
   </soap:Body>
</soap:Envelope>
```

**Плюсы SOAP:**
1) **Платформо-независимость.** Работает на любой платформе с поддержкой XML
2) **Надёжность.** Включает встроенные механизмы обработки ошибок и повторной доставки сообщений
3) **Безопасность.** Поддержка WS-Security для шифрования, аутентификации и защиты данных
4) **Формализация контрактов.** [[WSDL]] помогает чётко определить интерфейсы сервиса, что важно для больших корпоративных приложений

**Минусы SOAP:**
1) **Сложность.** Сложнее чем REST
2) **Медленное выполнение.** Формат XML увеличивает объём сообщений, что может замедлять передачу данных
3) **Чувствительность к пространству имён.** Требует строгого соблюдения соглашений о наименованиях
4) **Меньшая гибкость.** SOAP требует строго следования стандартам

**Когда использовать SOAP:**
1) **Крупные корпоративные приложения.** Когда требуются выысокая степень надёжности и безопасности
2) **Интеграция с устаревшими системами**. Многие старые системы используют только SOAP
3) **Гарантии доставки сообщений.** Подходит для критически важных систем, где требуется подтверждение доставки
4) **Использование сложных контрактов.** Если требуются строгая форма интерфейса

**Дополнительные возможности SOAP:**
1) **WS-ReliableMessaging:**
	1) **Гарантия доставки.** Сообщения будут доставлены, даже если произойдут сетевые сбои
	2) **Порядок доставки.** Сообщения будут доставлены в порядке отправления
	3) **Отсутствование дублирования.** Каждон сообщение будет доставлено ровно один раз
2) **WS-AtomicTransaction:**
	1) **Атомарность.** Транзакции выполняются как единое целое
	2) **Согласованность.** Данные остаются в согласованном состоянии до и после выполнения транзакций
	3) **Изолированность.** Взаимодействие с данными другими транзакциями без влияния на текущую транзакцию
	4) **Долговечность.** Результаты транзакций сохраняются даже в случае сбоя системы
3) **WS-Addressing:**
	1) **Абстрактные адреса.** Позоволяет ссылаться на конечные точки и операции без привязки к конкретным транспортным протоколам
	2) **Маршрутизация сообщения.** Упрощённая маршрутизация сообщений между сервисами
4) **SOAP Faults:**
	1) **Код ошибки.** Указывает тип ошибки
	2) **Сообщение об ошибке.** Описание ошибки
	3) **Подробности ошибки.** Дополнительные данные, объясняющие природу ошибки